<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice CRUD</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="p-4 container">

    <h2 class="mb-4 ">Invoice CRUD System</h2>

    <!-- Invoice Form -->
    <form id="invoiceForm" class="mb-3">
        <div class="row g-2">
            <div class="col-md-3">
                <input type="text" id="description" class="form-control" placeholder="Description" required>
            </div>
            <div class="col-md-2">
                <input type="number" id="qty" class="form-control" placeholder="Qty" required>
            </div>
            <div class="col-md-2">
                <input type="number" id="price" class="form-control" placeholder="Price" required>
            </div>
            <div class="col-md-3">
                <button type="submit" class="btn btn-primary w-100">Add Item</button>
            </div>
        </div>
    </form>

    <!-- Invoice Table -->
    <table class="table table-bordered">
        <thead class="table-light">
            <tr>
                <th>No</th>
                <th>Description</th>
                <th>Qty</th>
                <th>Price</th>
                <th>Subtotal</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="invoiceTable"></tbody>
    </table>

    <h4 class="text-end">Grand Total: $<span id="grandTotal">0</span></h4>

    <script>
        let invoices = [];
        let editIndex = null;

        function renderTable() {
            const tbody = document.getElementById("invoiceTable");
            tbody.innerHTML = "";
            let total = 0;

            invoices.forEach((item, index) => {
                let subtotal = item.qty * item.price;
                total += subtotal;

                tbody.innerHTML += `
          <tr>
            <td>${index + 1}</td>
            <td>${item.description}</td>
            <td>${item.qty}</td>
            <td>$${item.price}</td>
            <td>$${subtotal}</td>
            <td>
              <button class="btn btn-warning btn-sm" onclick="editItem(${index})">Edit</button>
              <button class="btn btn-danger btn-sm" onclick="deleteItem(${index})">Delete</button>
            </td>
          </tr>
        `;
            });

            document.getElementById("grandTotal").textContent = total;
        }

        document.getElementById("invoiceForm").addEventListener("submit", function (e) {
            e.preventDefault();
            const description = document.getElementById("description").value;
            const qty = parseInt(document.getElementById("qty").value);
            const price = parseFloat(document.getElementById("price").value);

            if (editIndex === null) {
                invoices.push({ description, qty, price });
            } else {
                invoices[editIndex] = { description, qty, price };
                editIndex = null;
            }

            this.reset();
            renderTable();
        });

        function editItem(index) {
            const item = invoices[index];
            document.getElementById("description").value = item.description;
            document.getElementById("qty").value = item.qty;
            document.getElementById("price").value = item.price;
            editIndex = index;
        }

        function deleteItem(index) {
            invoices.splice(index, 1);
            renderTable();
        }
    </script>
</body>

</html>