<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CURD</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>
<section class="container py-5">
    <section class="row">
        <div class="col-md-4 border p-4">
            <h3>Add Data...</h3>
            <div class="mb-3 mt-3">
        
                <input type="text" class="form-control" id="name" placeholder="Enter name">
            </div>
            <div class="mb-3 mt-3">
                
                <input type="number" class="form-control" id="phone" placeholder="Enter Phone">
            </div>
            <div class="mb-3 mt-3">
                
                <input type="email" class="form-control " id="email" placeholder="Enter email">
            </div>
            <button class="btn btn-sm btn-success w-100" id="ddd" onclick="add()">Add Data</button>
        </div>
        <div class="col-md-8 border p-4">
            <h3>Data List....</h3>
            <section class="row">
                <div class="col border p-2 fw-bold text-center fst-italic ">SR No</div>
                <div class="col border p-2 fw-bold text-center fst-italic">Name</div>
                <div class="col border p-2 fw-bold text-center fst-italic ">Email</div>
                <div class="col border p-2 fw-bold text-center fst-italic">Phone</div>
                <div class="col border p-2 fw-bold text-center fst-italic">Action</div>
            </section>
            <section class="ss">

            </section>
        </div>

    </section>
    </section>

    <script>
        // Fisrt time visite
        var database = JSON.parse(localStorage.getItem('data')) || [];
        showData();

        // Comman variable for reuse 
        var username = document.getElementById('name');
        var userphone = document.getElementById('phone');
        var useremail = document.getElementById('email');
        var btn = document.getElementById('ddd');
        var masterIndex = null;

        // to add and update data
        function add() {
            let obj = { 'name': username.value, "phone": userphone.value, "email": useremail.value };
            // add data
            if ("Add Data" == btn.innerText) {
                if (username.value != '' && useremail.value != '' && userphone.value != '') {
                    database.push(obj);
                }
            } else {
                //Update data
                database.splice(masterIndex, 1, obj);
                masterIndex = null;
                btn.innerText = 'Add Data';
            }

            useremail.value = ''; // empty input feild
            username.value = '';
            userphone.value = '';
            localStorage.setItem("data", JSON.stringify(database));  // To store
            showData();
        }

        //Data Display

        function showData() {
            var red = ''
            database.forEach((i, index) => {
                red += `
              <section class="row">
                <div class="col border p-2">${index + 1}</div>
                <div class="col border p-2">${i.name}</div>
                <div class="col border p-2">${i.email}</div>
                <div class="col border p-2">${i.phone}</div>
                <div class="col border p-2"> 
                    <button class="btn btn-sm btn-success" onclick="editDat(${index})">Edit</button> 
                    <button class="btn btn-sm btn-danger" onclick="deleteData(${index})">Delete</button></div>
              </section>
              `
            })
            document.getElementsByClassName("ss")[0].innerHTML = red;
        }


        // Delete the record
        function deleteData(index) {
            database.splice(index, 1);
            localStorage.setItem("data", JSON.stringify(database));
            showData();
        }


        // Set data in  input tag 
        function editDat(index) {
            masterIndex = index;
            btn.innerText = "Update Data";
            useremail.value = database[index].email;
            username.value = database[index].name;
            userphone.value = database[index].phone;
        }

    </script>


</body>

</html>